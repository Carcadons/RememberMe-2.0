<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="RememberMe">
    <meta name="description" content="Private pocket-dossier for remembering people before meetings">
    <meta name="theme-color" content="#6366f1">

    <!-- Icons -->
    <!-- iOS requires PNG for home screen icons, not SVG -->
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg">
    <link rel="alternate icon" type="image/svg+xml" href="/images/favicon.svg">

    <!-- iOS Home Screen Icons (PNG format required) -->
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76.png">

    <!-- For Safari pinned tabs -->
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#6366f1">

    <!-- Standard icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">

    <!-- iOS specific -->
    <link rel="apple-touch-startup-image" href="/icons/splash-screen.png">

    <title>RememberMe</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="/css/design-system.css">
    <link rel="stylesheet" href="/css/components.css">

    <style>
        #importMenu.hidden {
            display: none !important;
        }

        #importMenu {
            animation: slideUp 0.2s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-brand" style="display: flex; align-items: center; gap: 0.75rem;">
                <img src="/images/favicon.svg" alt="RememberMe" width="32" height="32" style="border-radius: 8px;">
                <div>
                    <h1 class="header-title">RememberMe</h1>
                    <p class="header-subtitle">Your people, remembered</p>
                </div>
            </div>

            <div style="display: flex; align-items: center; gap: 0.75rem;">
                <!-- Connection Status Indicator -->
                <div id="connectionStatus" class="connection-indicator" title="Online" style="display: flex; align-items: center; gap: 0.25rem; padding: 0.5rem; border-radius: 20px; background: rgba(16, 185, 129, 0.1); color: #10b981; font-size: 0.75rem; font-weight: 500;">
                    <span style="width: 8px; height: 8px; border-radius: 50%; background: #10b981;"></span>
                    <span>Online</span>
                </div>

                <!-- User Menu -->
                <div class="user-menu" style="position: relative;">
                    <button class="btn btn-secondary" id="userMenuBtn" style="display: flex; align-items: center; gap: 0.5rem; padding: 0.5rem;">
                        <span id="userInitial">üë§</span>
                    </button>

                    <!-- User Menu Dropdown -->
                    <div id="userMenuDropdown" class="dropdown-menu hidden" style="position: absolute; top: 100%; right: 0; margin-top: 0.5rem; min-width: 200px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--radius); box-shadow: var(--shadow-lg); z-index: 1000;">
                        <div class="dropdown-header" style="padding: 1rem; border-bottom: 1px solid var(--border-color);">
                            <div id="userName" style="font-weight: 600; font-size: 0.875rem;"></div>
                            <div id="userEmail" style="font-size: 0.75rem; color: var(--text-secondary);"></div>
                        </div>

                        <div class="dropdown-content" style="padding: 0.5rem;">
                            <button id="logoutBtn" class="dropdown-item" style="width: 100%; display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; border: none; background: none; border-radius: var(--radius-xs); font-size: 0.875rem; cursor: pointer; transition: var(--transition);">
                                üë§ Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Today View -->
            <div id="todayView" class="view active">
                <div class="empty-state" id="todayEmpty">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                    </svg>
                    <h3 class="text-gradient">No Meetings Today</h3>
                    <p>You have no meetings scheduled for today</p>
                </div>
                <div id="todayList" class="hidden"></div>
            </div>

            <!-- Contacts View -->
            <div id="contactsView" class="view">
                <input type="text" class="search-bar" id="searchInput" placeholder="Search by name, company, or tags...">
                <div id="contactsEmpty" class="empty-state">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                    </svg>
                    <h3 class="text-gradient">No Contacts Yet</h3>
                    <p>Import or add contacts to get started</p>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem; max-width: 300px; margin: 1.5rem auto 0;">
                        <button class="btn btn-secondary" id="importContactsBtnDesktop">
                            üì± Import from iPhone
                        </button>
                        <button class="btn btn-secondary" id="importLinkedinBtnDesktop">
                            üíº Import LinkedIn
                        </button>
                    </div>
                </div>
                <div id="contactsList" class="hidden"></div>
            </div>

            <!-- Starred View -->
            <div id="starredView" class="view">
                <div class="empty-state" id="starredEmpty">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                    </svg>
                    <h3 class="text-gradient">No Starred Contacts</h3>
                    <p>Star important people for quick access</p>
                </div>
                <div id="starredList" class="hidden"></div>
            </div>

            <!-- Loading State -->
            <div id="loadingState" class="loading hidden">
                <div class="spinner"></div>
                <p>Loading your contacts...</p>
            </div>
        </main>

        <!-- Floating Action Button -->
        <button class="fab" id="addPersonBtn" title="Add new contact">
            +
        </button>

        <!-- Import Menu (Hidden by default) -->
        <div id="importMenu" class="hidden" style="position: fixed; bottom: 160px; right: 24px; display: flex; flex-direction: column; gap: 0.75rem; z-index: 998;">
            <!-- Add Manual Contact (Primary Action) -->
            <button class="btn btn-primary" id="addManualContactBtn" style="box-shadow: 0 4px 12px rgba(0,0,0,0.15); border-radius: 24px; padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                ‚úèÔ∏è Create Contact
            </button>
            <button class="btn btn-secondary" id="importContactsBtnMobile" style="box-shadow: 0 4px 12px rgba(0,0,0,0.15); border-radius: 24px; padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                üì± iPhone Contacts
            </button>
            <button class="btn btn-secondary" id="importLinkedinBtnMobile" style="box-shadow: 0 4px 12px rgba(0,0,0,0.15); border-radius: 24px; padding: 0.75rem 1.5rem; font-size: 0.875rem;">
                üíº LinkedIn
            </button>
        </div>

        <!-- Tab Bar -->
        <nav class="tab-bar">
            <button class="tab-button active" data-view="todayView">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                <span>Today</span>
            </button>
            <button class="tab-button" data-view="contactsView">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
                <span>Contacts</span>
            </button>
            <button class="tab-button" data-view="starredView">
                <svg class="tab-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
                <span>Starred</span>
            </button>
        </nav>
    </div>

    <!-- JavaScript Library -->
    <script src="https://unpkg.com/@phosphor-icons/web@2.1.1"></script>

    <!-- App Scripts -->
    <script src="/src/utils/encryption.js"></script>
    <script src="/src/core/storage.js"></script>
    <script src="/src/core/auth.js"></script>
    <script src="/src/core/sync-postgres.js"></script>
    <script src="/src/core/security.js"></script>
    <script src="/src/components/AuthModal.js"></script>
    <script src="/src/components/UserMenu.js"></script>
    <script src="/src/components/TodayView.js"></script>
    <script src="/src/components/Search.js"></script>
    <script src="/src/components/StarredView.js"></script>
    <script src="/src/components/AddContactModal.js"></script>
    <script src="/src/components/ContactDetail.js"></script>
    <script src="/src/app.js"></script>
</body>
</html>
